package utils

type NicknamePool struct {
	prefix *SyncMap[string, struct{}]
	suffix *SyncMap[string, struct{}]
	used   *SyncMap[string, struct{}]
}

func NewNicknamePool() *NicknamePool {
	prefix := NewSyncMap[string, struct{}]()
	prefix.Stores(_prefixList)

	suffix := NewSyncMap[string, struct{}]()
	suffix.Stores(_suffixList)
	return &NicknamePool{
		prefix: prefix,
		suffix: suffix,
		used:   NewSyncMap[string, struct{}](),
	}
}

func (a *NicknamePool) Take() (string, bool) {
	if a.suffix.Len() == 0 {
		return "", false
	}

	prefix := a.prefix.KeySlice()
	suffix := a.suffix.KeySlice()

	for _, p := range prefix {
		for _, s := range suffix {
			result := p + s
			if _, used := a.used.Swap(result, struct{}{}); !used {
				return result, true
			}
		}
	}

	return "", false
}

var _prefixList = map[string]struct{}{
	"蘋果":  {},
	"香蕉":  {},
	"柳橙":  {},
	"葡萄":  {},
	"菠蘿":  {},
	"芒果":  {},
	"櫻桃":  {},
	"草莓":  {},
	"藍莓":  {},
	"奇異果": {},
	"西瓜":  {},
	"哈密瓜": {},
	"柚子":  {},
	"李子":  {},
	"桃子":  {},
	"杏子":  {},
	"梨子":  {},
	"葡萄柚": {},
	"木瓜":  {},
	"鳳梨":  {},
	"椰子":  {},
	"檸檬":  {},
	"萊姆":  {},
	"楊桃":  {},
	"柿子":  {},
	"石榴":  {},
	"桑椹":  {},
	"莓果":  {},
	"橄欖":  {},
	"柑橘":  {},
	"獼猴桃": {},
	"火龍果": {},
	"榴槤":  {},
	"甘蔗":  {},
	"牛油果": {},
	"甜瓜":  {},
	"西柚":  {},
	"黃桃":  {},
	"青梅":  {},
	"葡萄乾": {},
	"龍眼":  {},
	"山竹":  {},
	"荔枝":  {},
	"桂圓":  {},
	"樹莓":  {},
	"覆盆子": {},
	"黑莓":  {},
	"釋迦":  {},
	"楊梅":  {},
	"紅毛丹": {},
	"山楂":  {},
	"芭樂":  {},
	"青檸":  {},
	"香瓜":  {},
	"玫瑰":  {},
	"向日葵": {},
	"鬱金香": {},
	"百合":  {},
	"康乃馨": {},
	"梅花":  {},
	"蘭花":  {},
	"茉莉花": {},
	"杜鵑花": {},
	"菊花":  {},
	"鳶尾花": {},
	"蓮花":  {},
	"牡丹":  {},
	"芍藥":  {},
	"櫻花":  {},
	"石榴花": {},
	"茶花":  {},
	"牡丹花": {},
	"丁香花": {},
	"薰衣草": {},
	"百合花": {},
	"滿天星": {},
	"雞冠花": {},
	"虞美人": {},
	"風信子": {},
	"石蒜":  {},
	"大岩桐": {},
	"大理花": {},
	"含笑花": {},
	"夜來香": {},
	"菩提樹": {},
	"荷花":  {},
	"銀杏樹": {},
	"楓樹":  {},
	"櫸樹":  {},
	"槭樹":  {},
	"榕樹":  {},
	"柳樹":  {},
	"白樺樹": {},
	"枇杷樹": {},
	"梨樹":  {},
	"蘋果樹": {},
	"橄欖樹": {},
	"橙樹":  {},
	"柚樹":  {},
	"柿樹":  {},
	"山茶樹": {},
	"桃樹":  {},
	"楊梅樹": {},
	"櫻桃樹": {},
	"葡萄樹": {},
	"榴槤樹": {},
	"荔枝樹": {},
	"龍眼樹": {},
	"桑樹":  {},
	"楊桃樹": {},
	"蝴蝶蘭": {},
}

var _suffixList = map[string]struct{}{
	"獅子":  {},
	"老虎":  {},
	"大象":  {},
	"熊貓":  {},
	"鱷魚":  {},
	"鯊魚":  {},
	"袋鼠":  {},
	"狼":   {},
	"狐狸":  {},
	"獵豹":  {},
	"孔雀":  {},
	"鷹":   {},
	"鴨":   {},
	"貓頭鷹": {},
	"長頸鹿": {},
	"犀牛":  {},
	"羚羊":  {},
	"河馬":  {},
	"麋鹿":  {},
	"兔子":  {},
	"鼴鼠":  {},
	"海豚":  {},
	"烏龜":  {},
	"螃蟹":  {},
	"蜻蜓":  {},
	"蝴蝶":  {},
	"蜜蜂":  {},
	"蚊子":  {},
	"螞蟻":  {},
	"蜥蜴":  {},
	"壁虎":  {},
	"青蛙":  {},
	"蛇":   {},
	"蝙蝠":  {},
	"鴿子":  {},
	"鶴":   {},
	"天鵝":  {},
	"鳥":   {},
	"鴕鳥":  {},
	"鸚鵡":  {},
	"斑馬":  {},
	"駱駝":  {},
	"刺蝟":  {},
	"老鼠":  {},
	"松鼠":  {},
	"黑熊":  {},
	"紅鶴":  {},
	"海獺":  {},
	"海星":  {},
	"海膽":  {},
	"鯨魚":  {},
	"水母":  {},
	"海豹":  {},
	"企鵝":  {},
	"沙魚":  {},
	"龍蝦":  {},
	"水牛":  {},
	"蜂鳥":  {},
	"狗":   {},
	"貓":   {},
	"蝦":   {},
	"鵝":   {},
	"虎鯨":  {},
	"章魚":  {},
	"鱔魚":  {},
}
